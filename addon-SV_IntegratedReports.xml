<?xml version="1.0" encoding="utf-8"?>
<addon addon_id="SV_IntegratedReports" title="Integrated Reports" version_string="0.0.7" version_id="7" url="" install_callback_class="SV_IntegratedReports_Listener" install_callback_method="install" uninstall_callback_class="SV_IntegratedReports_Listener" uninstall_callback_method="uninstall">
  <admin_navigation/>
  <admin_permissions/>
  <admin_style_properties/>
  <admin_templates/>
  <admin_template_modifications>
    <modification template="user_edit" modification_key="sv_integrated_report_user_edit" description="Add Spam Cleaner" execution_order="10" enabled="1" action="str_replace">
      <find><![CDATA[<li><a href="{xen:adminlink banning/users/add, $user}" class="OverlayTrigger">{xen:phrase ban_user}</a></li>]]></find>
      <replace><![CDATA[$0
<li><a href="{xen:link spam-cleaner, $user}" class="OverlayTrigger">{xen:phrase spam_cleaner}</a></li>]]></replace>
    </modification>
  </admin_template_modifications>
  <code_events/>
  <code_event_listeners>
    <listener event_id="load_class" execute_order="10" callback_class="SV_IntegratedReports_Listener" callback_method="load_class" active="1" hint="XenForo_ControllerPublic_Member" description="XenForo_ControllerPublic_Member"/>
    <listener event_id="load_class" execute_order="10" callback_class="SV_IntegratedReports_Listener" callback_method="load_class" active="1" hint="XenForo_ControllerPublic_Warning" description="XenForo_ControllerPublic_Warning"/>
    <listener event_id="load_class" execute_order="10" callback_class="SV_IntegratedReports_Listener" callback_method="load_class" active="1" hint="XenForo_Model_Conversation" description=""/>
    <listener event_id="load_class" execute_order="10" callback_class="SV_IntegratedReports_Listener" callback_method="load_class" active="1" hint="XenForo_Model_Forum" description=""/>
    <listener event_id="load_class" execute_order="10" callback_class="SV_IntegratedReports_Listener" callback_method="load_class" active="1" hint="XenForo_Model_User" description=""/>
    <listener event_id="load_class" execute_order="10" callback_class="SV_IntegratedReports_Listener" callback_method="load_class" active="1" hint="XenForo_Model_ProfilePost" description=""/>
    <listener event_id="load_class" execute_order="10" callback_class="SV_IntegratedReports_Listener" callback_method="load_class" active="1" hint="XenForo_Model_Report" description=""/>
    <listener event_id="load_class" execute_order="10" callback_class="SV_IntegratedReports_Listener" callback_method="load_class" active="1" hint="XenForo_Model_Warning" description=""/>
    <listener event_id="load_class" execute_order="10" callback_class="SV_IntegratedReports_Listener" callback_method="load_class" active="1" hint="XenForo_ReportHandler_Post" description=""/>
    <listener event_id="load_class" execute_order="10" callback_class="SV_IntegratedReports_Listener" callback_method="load_class" active="1" hint="XenForo_ReportHandler_ProfilePost" description=""/>
    <listener event_id="load_class" execute_order="10" callback_class="SV_IntegratedReports_Listener" callback_method="load_class" active="1" hint="XenForo_ReportHandler_User" description=""/>
    <listener event_id="load_class" execute_order="10" callback_class="SV_IntegratedReports_Listener" callback_method="load_class" active="1" hint="XenForo_DataWriter_Warning" description=""/>
    <listener event_id="load_class" execute_order="10" callback_class="SV_IntegratedReports_Listener" callback_method="load_class" active="1" hint="XenForo_DataWriter_ReportComment" description=""/>
  </code_event_listeners>
  <cron/>
  <email_templates/>
  <email_template_modifications/>
  <optiongroups>
    <group group_id="sv_integrated_reports" display_order="141" debug_only="0"/>
    <option option_id="sv_default_resolve_report_on_warning" edit_format="onoff" data_type="boolean" can_backup="1">
      <default_value>1</default_value>
      <edit_format_params></edit_format_params>
      <sub_options></sub_options>
      <relation group_id="sv_integrated_reports" display_order="110"/>
    </option>
    <option option_id="sv_ir_log_to_report_natural_warning_expire" edit_format="onoff" data_type="boolean" can_backup="1">
      <default_value>0</default_value>
      <edit_format_params></edit_format_params>
      <sub_options></sub_options>
      <relation group_id="sv_integrated_reports" display_order="10"/>
    </option>
    <option option_id="sv_ir_user_id" edit_format="textbox" data_type="unsigned_integer" can_backup="1">
      <default_value>1</default_value>
      <edit_format_params></edit_format_params>
      <sub_options></sub_options>
      <relation group_id="sv_integrated_reports" display_order="1"/>
    </option>
    <option option_id="sv_report_new_warnings" edit_format="onoff" data_type="boolean" can_backup="1">
      <default_value>0</default_value>
      <edit_format_params></edit_format_params>
      <sub_options></sub_options>
      <relation group_id="sv_integrated_reports" display_order="100"/>
    </option>
  </optiongroups>
  <permissions>
    <permission_groups/>
    <permissions>
      <permission permission_group_id="conversation" permission_id="viewReportConversation" permission_type="flag" default_value="unset" interface_group_id="conversationModeratorPermissions" display_order="400"/>
      <permission permission_group_id="forum" permission_id="viewReportPost" permission_type="flag" default_value="unset" interface_group_id="forumModeratorPermissions" display_order="400"/>
      <permission permission_group_id="general" permission_id="viewReportUser" permission_type="flag" default_value="unset" interface_group_id="generalModeratorPermissions" display_order="400"/>
      <permission permission_group_id="profilePost" permission_id="viewReportProfilePost" permission_type="flag" default_value="unset" interface_group_id="profilePostModeratorPermissions" display_order="400"/>
    </permissions>
    <interface_groups/>
  </permissions>
  <phrases>
    <phrase title="a_report_will_be_created" version_id="4" version_string="0.0.4"><![CDATA[A report will be created.]]></phrase>
    <phrase title="option_group_sv_integrated_reports" version_id="3" version_string="0.0.3b"><![CDATA[Integrated Reports]]></phrase>
    <phrase title="option_group_sv_integrated_reports_description" version_id="1" version_string="0.0.1"><![CDATA[]]></phrase>
    <phrase title="option_sv_default_resolve_report_on_warning" version_id="4" version_string="0.0.4"><![CDATA[Resolve Report on Warning]]></phrase>
    <phrase title="option_sv_default_resolve_report_on_warning_explain" version_id="4" version_string="0.0.4"><![CDATA[By default, resolve an contents report when creating a warning.]]></phrase>
    <phrase title="option_sv_ir_log_to_report_natural_warning_expire" version_id="2" version_string="0.0.2"><![CDATA[Log Automatically Expiring Warning to Report]]></phrase>
    <phrase title="option_sv_ir_log_to_report_natural_warning_expire_explain" version_id="2" version_string="0.0.2"><![CDATA[]]></phrase>
    <phrase title="option_sv_ir_user_id" version_id="1" version_string="0.0.1"><![CDATA[Reporter]]></phrase>
    <phrase title="option_sv_ir_user_id_explain" version_id="1" version_string="0.0.1"><![CDATA[Enter the user id of the person reporting Alter Ego's]]></phrase>
    <phrase title="option_sv_report_new_warnings" version_id="3" version_string="0.0.3b"><![CDATA[Report New Warnings]]></phrase>
    <phrase title="option_sv_report_new_warnings_explain" version_id="3" version_string="0.0.3b"><![CDATA[Automatically create Reports for Warnings on content without an associated report]]></phrase>
    <phrase title="permission_conversation_viewReportConversation" version_id="1" version_string="0.0.1"><![CDATA[View Conversation Report]]></phrase>
    <phrase title="permission_forum_viewReportPost" version_id="1" version_string="0.0.1"><![CDATA[View Post Report]]></phrase>
    <phrase title="permission_general_viewReportUser" version_id="1" version_string="0.0.1"><![CDATA[View User Report]]></phrase>
    <phrase title="permission_profilePost_viewReportProfilePost" version_id="1" version_string="0.0.1"><![CDATA[View ProfilePost Report]]></phrase>
    <phrase title="report_options" version_id="4" version_string="0.0.4"><![CDATA[Report Options]]></phrase>
    <phrase title="resolve_linked_report" version_id="4" version_string="0.0.4"><![CDATA[Resolve linked report]]></phrase>
    <phrase title="sv_ir_operation_type_delete" version_id="2" version_string="0.0.2"><![CDATA[Deleted Warning]]></phrase>
    <phrase title="sv_ir_operation_type_edit" version_id="2" version_string="0.0.2"><![CDATA[Edited Warning]]></phrase>
    <phrase title="sv_ir_operation_type_expire" version_id="2" version_string="0.0.2"><![CDATA[Expired Warning]]></phrase>
    <phrase title="sv_ir_operation_type_new" version_id="2" version_string="0.0.2"><![CDATA[New Warning]]></phrase>
    <phrase title="sv_ir_x_commented_on_report" version_id="7" version_string="0.0.7"><![CDATA[{name} commented on the report {report}.]]></phrase>
    <phrase title="warning_log_operation_type" version_id="1" version_string="0.0.1"><![CDATA[Operation Type]]></phrase>
  </phrases>
  <route_prefixes/>
  <style_properties/>
  <templates>
    <template title="alert_report_comment" version_id="7" version_string="0.0.7"><![CDATA[<xen:if is='{$content.extra.report_comment_id}'>
<xen:set var="$extra">#reportComment-{$content.extra.report_comment_id}</xen:set>
</xen:if>

{xen:phrase sv_ir_x_commented_on_report,
	'name={xen:helper username, $user, 'subject'}',
	'report=<a href="{xen:link reports, $content}{$extra}" class="PopupItemLink">{$content.title}</a>'
}]]></template>
    <template title="ir_report_display" version_id="4" version_string="0.0.4"><![CDATA[<xen:if is="{$report}">
	<div class="discussionList section">
		<dl class="sectionHeaders">
			<dt class="posterAvatar"><a><span></span></a></dt>
			<dd class="main">
				<a class="title"><span>{xen:phrase content}</span></a>
			</dd>
			<dd class="stats">
				<a class="major"><span>{xen:phrase comments}</span></a>
			</dd>
			<dd class="lastPost"><a><span>{xen:phrase last_modified}</span></a></dd>
		</dl>
		<ol class="discussionListItems">	
			<xen:include template="report_list_item" />
		</ol>
	</div>
</xen:if>]]></template>
    <template title="member_warn_ir_options" version_id="4" version_string="0.0.4"><![CDATA[			<fieldset>
				<dl class="ctrlUnit">
					<dt>{xen:phrase report_options}:</dt>
					<dd>
						<ul>
							<li><label><input type="checkbox" id="resolveLinkedReport" name="resolve_linked_report" value="1" class="Disabler" {xen:if $xenOptions.sv_default_resolve_report_on_warning, 'checked="checked"' } /> {xen:phrase resolve_linked_report} </label></li>
							<xen:if is="!{$report}">
								<li>{xen:phrase a_report_will_be_created}</li>
							</xen:if>
						</ul>
					</dd>
				</dl>
			</fieldset>
<xen:include template="ir_report_display" />
	]]></template>
    <template title="sv_report_view_warning" version_id="4" version_string="0.0.4"><![CDATA[<xen:if is="{$comment.operation_type}">
<p class="warningLog">
<div class="pairsJustified">
<dl><dt>{xen:phrase warning_log_operation_type}</dt>
<dd class="warning_{$comment.operation_type}">
<xen:if is="{$comment.operation_type} == 'new'" >
	{xen:phrase sv_ir_operation_type_new}
<xen:elseif  is="{$comment.operation_type} == 'delete'" />
	{xen:phrase sv_ir_operation_type_delete}
<xen:elseif  is="{$comment.operation_type} == 'expire'" />
	{xen:phrase sv_ir_operation_type_expire}
<xen:elseif  is="{$comment.operation_type} == 'edit'" />
	{xen:phrase sv_ir_operation_type_edit}
<xen:else />
	{$comment.operation_type}
</xen:if>
</dd></dl>
<dl><dt>{xen:phrase warning}</dt><dd>{$comment.title}</dd></dl>
<dl><dt>{xen:phrase points}</dt><dd>{xen:number $comment.points}</dd></dl>
<dl><dt>{xen:phrase expiry}</dt><dd><xen:if is="{$comment.expiry_date}"><xen:datetime time="{$comment.expiry_date}" /><xen:else />{xen:phrase n_a}</xen:if></dd></dl>
<xen:if is="{$comment.warning_id}">
<dl><dt>{xen:phrase warning}</dt><dd><a href="{xen:link warnings, $comment}" class="OverlayTrigger secondaryContent">{xen:phrase view}</a></dd></dl>
</xen:if>
	<xen:if is="{$comment.notes}">
		{xen:phrase notes}:<br/>{xen:helper bodytext, $comment.notes}
	</xen:if>
</div>
</p>
</xen:if>
]]></template>
  </templates>
  <public_template_modifications>
    <modification template="member_warn" modification_key="sv_integrated_report_member_warn_ir_options" description="Inject more options" execution_order="10" enabled="1" action="preg_replace">
      <find><![CDATA[#(<fieldset>.*?{xen:phrase notes}.*?</fieldset>)#s]]></find>
      <replace><![CDATA[$1
<xen:include template="member_warn_ir_options" />]]></replace>
    </modification>
    <modification template="moderation_queue_list" modification_key="sv_integrated_report_moderation_queue_list" description="Add Spam Cleaner to moderation queue" execution_order="100" enabled="1" action="str_replace">
      <find><![CDATA[{$entry.content.user.username}</a>]]></find>
      <replace><![CDATA[$0<a style="margin-left:30px" target="_blank" href="spam-cleaner/{$entry.content.user.user_id}/?noredirect=1">Spam Cleaner</a>]]></replace>
    </modification>
    <modification template="report_view" modification_key="sv_integrated_report_report_list_item" description="Add anchor tags" execution_order="10" enabled="1" action="str_replace">
      <find><![CDATA[<li class="primaryContent reportComment {xen:if '!{$comment.is_report}', staffComment}"]]></find>
      <replace><![CDATA[$0 id="reportComment-{$comment.report_comment_id}"]]></replace>
    </modification>
    <modification template="report_view" modification_key="sv_integrated_report_report_view" description="Insert extra state tracking into the report comments." execution_order="10" enabled="1" action="preg_replace">
      <find><![CDATA[#(<div class="content">.*?)(</div>)#s]]></find>
      <replace><![CDATA[$1
<xen:include template="sv_report_view_warning" />
$2]]></replace>
    </modification>
    <modification template="warning_info" modification_key="sv_integrated_report_warning_info" description="Show Report info on warning" execution_order="5" enabled="1" action="str_replace">
      <find><![CDATA[<xen:if is="{$canDeleteWarning} AND {$canExpireWarning}">]]></find>
      <replace><![CDATA[<xen:include template="ir_report_display" />
$0]]></replace>
    </modification>
  </public_template_modifications>
  <bb_code_media_sites/>
  <bb_codes/>
</addon>
